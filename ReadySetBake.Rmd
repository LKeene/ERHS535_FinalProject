---
title: "Ready, Set, BAKE!"
author: "Lexi & Victoria"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
     
---

```{r setup, include=FALSE}
library(flexdashboard)
library(jsonlite)
library(maptools)
library(tidyverse)
library(leaflet)
library(DT)
library(bakeoff)
library(dygraphs)
library(lubridate)
library(xts)

bakers <- bakeoff::bakers
challenges <- bakeoff::challenges
episodes <- bakeoff::episodes
ratings <- bakeoff::ratings

```

Inputs {.sidebar}
-----------------------------------------------------------------------
<center>
<img src="https://media.giphy.com/media/LixsZBjJGgPo5RpyQt/giphy.gif" width="230">
</center>

<div align="center">### **Welcome to our ERHS 535 project!**


Our project is based on the #TidyTuesday Great British Bake Off data set. This 
data includes information about the baker's hometown (Plot 1), their 
standing (Table 1), and viewership metrics for seasons 1 - 10 (Plot 2). Click 
on **__** to view hometown locations by season. Click and drag the toggle to 
zoom in on viewership metrics. 


Authors: [Lexi](https://github.com/LKeene) & [Victoria](https://github.com/tashoo)  
Data Sources: [bakeoff package](https://bakeoff.netlify.app/)

<img src="data/bakeoff_logo.png" height="110px" width="100px" />
</div>

Column {data-width=650}
-----------------------------------------------------------------------

### **Viewership Across Seasons**
```{r}
viewers <- ratings %>% 
  mutate(uk_airdate = ymd(uk_airdate)) %>% 
  select(uk_airdate, viewers_7day, viewers_28day) 

xts <- xts(x = viewers[,-1], order.by = viewers$uk_airdate)

p <- dygraph(xts, ylab = "# viewers (millions)") %>% 
  dyOptions(stepPlot = TRUE) %>% 
  dySeries("viewers_7day", label = "7 Day Viewers")%>%
  dySeries("viewers_28day", label = "28 Day Viewers") %>% 
  dyHighlight(highlightCircleSize = 4, highlightSeriesBackgroundAlpha = 0.5) %>% 
  dyShading(from = "2010-08-17", to = "2010-09-21", color = "bisque") %>% 
  dyShading(from = "2011-08-18", to = "2011-10-04", color = "bisque") %>% 
  dyShading(from = "2012-08-14", to = "2012-10-22", color = "bisque") %>% 
  dyShading(from = "2013-08-20", to = "2013-10-22", color = "bisque") %>% 
  dyShading(from = "2014-08-06", to = "2014-10-08", color = "bisque") %>% 
  dyShading(from = "2015-08-05", to = "2015-10-07", color = "bisque") %>% 
  dyShading(from = "2016-08-24", to = "2016-10-26", color = "bisque") %>% 
  dyShading(from = "2017-08-29", to = "2017-10-31", color = "bisque") %>% 
  dyShading(from = "2018-08-28", to = "2018-10-30", color = "bisque") %>% 
  dyShading(from = "2019-08-27", to = "2019-10-29", color = "bisque") %>% 
  dyEvent("2014-08-06", "BBC One", labelLoc = "bottom") %>% 
  dyEvent("2017-08-29", "Channel 4", labelLoc = "bottom") %>% 
  dyRangeSelector()
p
```

Column {data-width=350}
-----------------------------------------------------------------------
### **Baker Hometowns**

```{r}
leaflet() %>% 
  addTiles() %>% 
  setView(lng = -4.5, lat = 53, zoom = 4.5) %>%
  addProviderTiles(providers$CartoDB.Voyager)


```





### **Baker Stats**
```{r}
challenges <- challenges %>% 
  filter(!is.na(result))

datatable(challenges, colnames = c("Series", "Episode", "Baker", "Result",
                                   "Signature", "Technical", "Showstopper"), 
          extensions = "Scroller", style="bootstrap", class="compact", 
          width="100%", options=list(deferRender=TRUE, scrollY=100, 
                                     scroller=TRUE, height = "fit-content"))

```



